<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Dice::RollPart</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Dice::RollPart</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/dicelib_rb.html">
                dicelib.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="SimplePart.html">
                SimplePart
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This represents the xDx part of the dice string. It takes the xDx part of
the dice string and parses it to get the individual parts. It also provides
methods for to get the <a href="RollPart.html#M000033">roll</a> result.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000040">&lt;=&gt;</a>&nbsp;&nbsp;
      <a href="#M000038">average</a>&nbsp;&nbsp;
      <a href="#M000031">has_rolled?</a>&nbsp;&nbsp;
      <a href="#M000036">maximum</a>&nbsp;&nbsp;
      <a href="#M000037">minimum</a>&nbsp;&nbsp;
      <a href="#M000029">new</a>&nbsp;&nbsp;
      <a href="#M000030">parse</a>&nbsp;&nbsp;
      <a href="#M000033">roll</a>&nbsp;&nbsp;
      <a href="#M000032">roll_die</a>&nbsp;&nbsp;
      <a href="#M000034">tally</a>&nbsp;&nbsp;
      <a href="#M000039">to_s</a>&nbsp;&nbsp;
      <a href="#M000035">total</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">parts</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(dstr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 110</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">dstr</span>)
      <span class="ruby-ivar">@total</span>  = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-ivar">@tally</span>  = []
      <span class="ruby-ivar">@value</span>  = <span class="ruby-identifier">dstr</span>

      <span class="ruby-comment cmt"># Our Default Values</span>
      <span class="ruby-ivar">@parts</span> = {
        <span class="ruby-identifier">:times</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>,
        <span class="ruby-identifier">:num</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>,
        <span class="ruby-identifier">:sides</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>,
        <span class="ruby-identifier">:keep</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
        <span class="ruby-identifier">:explode</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
        <span class="ruby-identifier">:reroll</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
        <span class="ruby-identifier">:mult</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      }

      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>()
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000040" class="method-detail">
        <a name="M000040"></a>

        <div class="method-heading">
          <a href="#M000040" class="method-signature">
          <span class="method-name">&lt;=&gt;</span><span class="method-args">(other)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000040-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000040-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 289</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;=&gt;</span>(<span class="ruby-identifier">other</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">total</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">total</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000038" class="method-detail">
        <a name="M000038"></a>

        <div class="method-heading">
          <a href="#M000038" class="method-signature">
          <span class="method-name">average</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000038-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000038-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 260</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">average</span>()
      <span class="ruby-comment cmt"># Returns a float, of course.</span>
      <span class="ruby-keyword kw">return</span> (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">maximum</span>() <span class="ruby-operator">+</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">minimum</span>()) <span class="ruby-operator">/</span> <span class="ruby-value">2.0</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="#M000031" class="method-signature">
          <span class="method-name">has_rolled?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Checks to see if this instance has rolled yet or not.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 169</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">has_rolled?</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@total</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000036" class="method-detail">
        <a name="M000036"></a>

        <div class="method-heading">
          <a href="#M000036" class="method-signature">
          <span class="method-name">maximum</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The following methods ignore any :times and :explode values, so these
won&#8216;t be overly helpful in figuring out statistics or anything.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000036-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000036-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 239</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">maximum</span>()
      <span class="ruby-identifier">num</span> = <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>].<span class="ruby-identifier">zero?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:num</span>] <span class="ruby-operator">:</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>]
      <span class="ruby-identifier">mult</span> = <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>].<span class="ruby-identifier">zero?</span> <span class="ruby-value">? </span><span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>]
      <span class="ruby-keyword kw">return</span> ((<span class="ruby-identifier">num</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>]) <span class="ruby-operator">*</span> <span class="ruby-identifier">mult</span>)
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000037" class="method-detail">
        <a name="M000037"></a>

        <div class="method-heading">
          <a href="#M000037" class="method-signature">
          <span class="method-name">minimum</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000037-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000037-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 245</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">minimum</span>()
      <span class="ruby-comment cmt"># Short-circuit-ish logic here; if :sides and :reroll</span>
      <span class="ruby-comment cmt"># are the same, return maximum() instead.</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">maximum</span>() <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>]

      <span class="ruby-identifier">num</span> = <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>].<span class="ruby-identifier">zero?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:num</span>] <span class="ruby-operator">:</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>]
      <span class="ruby-identifier">mult</span> = <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>].<span class="ruby-identifier">zero?</span> <span class="ruby-value">? </span><span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>]
        
      <span class="ruby-comment cmt"># Reroll value is &lt;=, so we have to add 1 to get </span>
      <span class="ruby-comment cmt"># the minimum value for the die.</span>
      <span class="ruby-identifier">sides</span> = <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>].<span class="ruby-identifier">zero?</span> <span class="ruby-value">? </span><span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>] <span class="ruby-operator">+</span> <span class="ruby-value">1</span>

      <span class="ruby-keyword kw">return</span> ((<span class="ruby-identifier">num</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">sides</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">mult</span>)
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">parse</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Uses the ROLL_REGEX constant to <a href="RollPart.html#M000030">parse</a>
the xDx string into the individual parts.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 131</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse</span>()

      <span class="ruby-identifier">dstr</span> = <span class="ruby-ivar">@value</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\s+/</span>, <span class="ruby-value str">&quot;&quot;</span>)
      <span class="ruby-identifier">parts</span> = <span class="ruby-constant">ROLL_REGEX</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">dstr</span>)

      <span class="ruby-comment cmt"># Handle any crunchy-bits we found.</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>
        <span class="ruby-identifier">parts</span> = <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">captures</span>.<span class="ruby-identifier">dup</span>()

        <span class="ruby-comment cmt"># Handle special d% sides</span>
        <span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>] = <span class="ruby-value">100</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;%&quot;</span>

        <span class="ruby-comment cmt"># Handle exploding value set to nothing.</span>
        <span class="ruby-comment cmt"># Set it to the max-value of the die.</span>
        <span class="ruby-identifier">parts</span>[<span class="ruby-value">3</span>] = <span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">3</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;e&quot;</span>

        <span class="ruby-comment cmt"># Convert them to numbers.</span>
        <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">collect!</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">nil?</span>
            <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">i</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^[!*er]/</span>, <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">to_i</span>()
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:num</span>]     = <span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
        <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>]   = <span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
        <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:explode</span>] = <span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
        <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>]    = <span class="ruby-identifier">parts</span>[<span class="ruby-value">3</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">3</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>]  = <span class="ruby-identifier">parts</span>[<span class="ruby-value">4</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">4</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>]    = <span class="ruby-identifier">parts</span>[<span class="ruby-value">5</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parts</span>[<span class="ruby-value">5</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">
          <a href="#M000033" class="method-signature">
          <span class="method-name">roll</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rolls the dice, saving the results in the @result instance variable.
@result is cleared before the <a href="RollPart.html#M000033">roll</a> is
handled.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000033-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000033-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 188</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">roll</span>
      <span class="ruby-identifier">results</span> = []

      <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:num</span>].<span class="ruby-identifier">times</span> <span class="ruby-keyword kw">do</span>
        <span class="ruby-identifier">roll</span> = <span class="ruby-identifier">roll_die</span>()

        <span class="ruby-identifier">results</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">roll</span>)

        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:explode</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
          <span class="ruby-identifier">explode_limit</span> = <span class="ruby-value">0</span>

          <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">roll</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:explode</span>]
            <span class="ruby-identifier">roll</span> = <span class="ruby-identifier">roll_die</span>()
            <span class="ruby-identifier">results</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">roll</span>)
            <span class="ruby-identifier">explode_limit</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
            <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">explode_limit</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-constant">EXPLODE_LIMIT</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-ivar">@tally</span> = <span class="ruby-identifier">results</span>.<span class="ruby-identifier">dup</span>()
      <span class="ruby-identifier">results</span>.<span class="ruby-identifier">sort!</span>.<span class="ruby-identifier">reverse!</span>

      <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">results</span> = <span class="ruby-identifier">results</span>[<span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>]]
      <span class="ruby-keyword kw">end</span>
       
      <span class="ruby-ivar">@total</span> = <span class="ruby-identifier">results</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">i</span>}
      <span class="ruby-ivar">@total</span> = <span class="ruby-identifier">total</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>

      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="#M000032" class="method-signature">
          <span class="method-name">roll_die</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rolls a single die from the xDx string.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 174</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">roll_die</span>()
      <span class="ruby-identifier">num</span> = <span class="ruby-value">0</span>
      <span class="ruby-identifier">reroll</span> = (<span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>] <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>]) <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>]

      <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">num</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">reroll</span>
        <span class="ruby-identifier">num</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>]) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">num</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">
          <a href="#M000034" class="method-signature">
          <span class="method-name">tally</span><span class="method-args">(do_sort=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="RollPart.html#M000034">tally</a> from the <a
href="RollPart.html#M000033">roll</a>. This is the entire <a
href="RollPart.html#M000034">tally</a>, even if a :keep option was given.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000034-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000034-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 223</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tally</span>(<span class="ruby-identifier">do_sort</span>=<span class="ruby-keyword kw">true</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@tally</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">reverse</span>() <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">do_sort</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@tally</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000039" class="method-detail">
        <a name="M000039"></a>

        <div class="method-heading">
          <a href="#M000039" class="method-signature">
          <span class="method-name">to_s</span><span class="method-args">(no_spaces=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This takes the @parts hash and recreates the xDx string. Optionally,
passing true to the method will remove spaces form the finished string.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000039-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000039-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 268</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">no_spaces</span>=<span class="ruby-keyword kw">false</span>)
      <span class="ruby-identifier">s</span> = <span class="ruby-value str">&quot;&quot;</span>

      <span class="ruby-identifier">sp</span> = <span class="ruby-identifier">no_spaces</span> <span class="ruby-value">? </span><span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot; &quot;</span>
      
      <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:num</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:num</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;d&quot;</span>
      <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>

      <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:explode</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;#{sp}e&quot;</span>
        <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:explode</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:explode</span>] <span class="ruby-operator">!=</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:sides</span>]
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;#{sp}*&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:mult</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;#{sp}!&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:keep</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;#{sp}r&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parts</span>[<span class="ruby-identifier">:reroll</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>

      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">s</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000035" class="method-detail">
        <a name="M000035"></a>

        <div class="method-heading">
          <a href="#M000035" class="method-signature">
          <span class="method-name">total</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the <a href="RollPart.html#M000035">total</a> of the last <a
href="RollPart.html#M000033">roll</a>; if there is no last <a
href="RollPart.html#M000033">roll</a>, it calls <a
href="RollPart.html#M000033">roll</a>() first.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000035-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000035-source">
<pre>
<span class="ruby-comment cmt"># File dicelib.rb, line 230</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">total</span>
      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">roll</span>() <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@total</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@total</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>